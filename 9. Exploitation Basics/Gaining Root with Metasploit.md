# Gaining Root with Metasploit

During the enumeration phase, we found out that the Samba version running on the Kioptrix machine was vulnerable to the the trans2open vulnerability. With that in mind, we can use metasploit to actually exploit this vulnerability and gain root access to the machine.

Launch metasploit using the `msfconsole` and use the `search` command to look for the trans2open exploit:

![msf_root_1](https://github.com/w1zzl3-06/TCM-Practical-Ethical-Hacking-Notes/assets/141921425/2296098c-532a-4b83-aeef-500bf105cbf1)

After selecting the exploit, we can use the `show options` to see the options that need to be changed:

![msf_root_2](https://github.com/w1zzl3-06/TCM-Practical-Ethical-Hacking-Notes/assets/141921425/9cbab1cc-cd3d-4d36-a11f-64b8ad792c2c)

All we need to do is give the IP of the target machine using `set rhosts` followed by the machine IP.

Now to run the exploit using the `exploit` command:

![msf_root_3](https://github.com/w1zzl3-06/TCM-Practical-Ethical-Hacking-Notes/assets/141921425/9177b60a-16f4-4dc6-bd12-2c6ce1e92634)

Unfortunately, our staged payload did not work. So lets try to use a non-staged payload.

We can set this payload by using the `set payload linux/x86/` command and choosing `linux/x86/shell_reverse_tcp`, once thatâ€™s done. Run the exploit again and we should have a shell with root access (the highest privileged user):

![msf_root_4](https://github.com/w1zzl3-06/TCM-Practical-Ethical-Hacking-Notes/assets/141921425/a98da34b-7adb-469d-8b28-1a23e68cfe0f)
