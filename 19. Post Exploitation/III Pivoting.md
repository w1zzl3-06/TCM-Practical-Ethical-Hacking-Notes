# III. Pivoting

This is a technique used by attackers to move within a network after gaining initial access. The goal of pivoting is to explore and compromise additional systems within the network, leveraging the initial foothold:

One of the tools used for pivoting is `proxychains` , this tool enables to route their network connections through proxy servers. Basically we can use this to spoof our IP addresses.

To use proxychains, first access the configuration file at `/etc/proxychains.conf`

Scroll down till we see `[ProxyList]`. This is where we add proxy addresses with their corresponding ports to bind to.

Now let’s say we have initial access to an account as root and we want to ssh into it:

`ssh -f -N -D <PORT> -i <ssh-file> root@<IP-Address>`

- **`f`**: Requests SSH to go to the background just before command execution. This is useful when we don't want to leave an open terminal session.
- **`N`**: Instructs SSH to not execute a remote command. It's useful for just forwarding ports.
- **`D [bind_address:]port`**: Specifies a local "dynamic" application-level port forwarding. This allocates a socket to listen to **`port`** on the local side. Whenever a connection is made to this port, the connection is forwarded over the secure channel, and the application protocol is then used to determine where to connect to from the remote machine.

Once executed. We will establish a connection to the machine in the background and now we can proxy our traffic through it to establish a connection and access the network.

This will allow us to:

- Run nmap through proxychains e.g. `proxychains nmap <Commands>`
- Run attacks. e.g Kerberoasting attack: `proxychains GetUserSPNs.py <DOMAIN NAME>/user:pass -dc-ip <DC-IP> -request`
- Access machine via RDP e.g.  `proxychains xfreerdp /u:administrator /p: 'Hacker321!' /v:10.10.10.10`

There’s another cool tool called [sshuttle](https://github.com/sshuttle/sshuttle) . Basically it allows us to connect to  a machine via ssh. And we’ll be able to run commands normally without adding something like `proxychains` before every command.

e.g: 

```bash
sshuttle -r root@10.10.155.5 10.10.10.0/24 --ssh-cmd "ssh -i pivot"
```

There’s also [Chisel](https://github.com/jpillora/chisel).